function countdownTimer(e,t,n){let o=t,r=setInterval(()=>{--o<0?(clearInterval(r),n()):e.textContent=`Resend OTP (${o}s)`},1e3)}console.log("hello from server");const form=document.getElementById("phone-form");form?.addEventListener("submit",async e=>{e.preventDefault();let t=new FormData(form),n=t.get("phone");try{let o=await fetch("http://localhost:8000/auth/generateOtp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phoneNumber:n,userType:"{{userType}}",storeId:"{{storeId}}"})}),r=await o.json();if("Success"===r.message){let a=document.getElementById("otp-container"),d=document.getElementById("phone"),s=form.querySelector('button[type="submit"]'),l=document.createElement("button");l.className="submit-button",l.type="button",l.innerText="Resend OTP",l.disabled=!0;let i=document.createElement("form");i.id="otp-form";let p=document.createElement("label");p.for="code",p.innerText="OTP Code:";let c=document.createElement("input");c.type="text",c.id="otp-input",c.name="otp-input",c.required=!0;let m=document.createElement("button");m.type="submit",m.innerText="Verify OTP",m.className="submit-button",i.appendChild(p),i.appendChild(c),i.appendChild(document.createElement("br")),i.appendChild(m),a.appendChild(i),d.disabled=!0,a.style.display="block",s.disabled=!0,s.innerText="Resend OTP (60)",countdownTimer(s,60),setTimeout(()=>{s.disabled=!1},6e4),i.addEventListener("submit",async e=>{e.preventDefault();let t=new FormData(i),n=t.get("otp-input"),o=document.getElementById("phone").value;try{let r=await fetch("http://localhost:8000/auth/verifyOtp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({otp:n,phoneNumber:o,userType:"{{userType}}",storeId:"{{storeId}}"})}),a=await r.json();"Success"===a.message?alert("Success"):alert("Invalid OTP code")}catch(d){console.error(d),alert("Failed to verify OTP code")}})}else alert("Failed to send OTP code")}catch(u){console.error(u),alert("Failed to send OTP code")}});
